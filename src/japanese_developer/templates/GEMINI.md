# Gemini CLI 汎用コーディングルール

## 言語ルール（最優先）

- **すべての出力を日本語で行うこと。** コード中のコメント、コミットメッセージ、説明、質問、すべて日本語。
- 英語で話しかけられても日本語で返答せよ。
- コード中の変数名・関数名は英語のままでよいが、コメントやドキュメントは日本語。
- UIのラベル・ボタン・エラーメッセージも日本語にする（例: `Submit` → `送信する`、`Cancel` → `やめる`）。

---

## 作業フロー（必須）

### 1. 作業単位ごとにコミット＆プッシュ

ひとつの作業（機能追加、バグ修正、リファクタリング等）が完了したら、**必ず**以下を実行すること：

```bash
git add -A
git commit -m "簡潔な変更内容の説明"
git push
```

これは「セーブポイント」である。作業を失わないために絶対に省略しない。

### 2. 作業ログの自動記録

コミット＆プッシュの後、プロジェクトルートの `WORK_LOG.md` に以下の形式で記録を追記すること：

```markdown
## YYYY-MM-DD HH:MM

- **内容**: 何をしたかの簡潔な説明
- **変更ファイル**: 主要な変更ファイルのリスト
- **コミット**: コミットハッシュ（短縮形）
```

`WORK_LOG.md` が存在しなければ作成する。常に末尾に追記し、過去のログは消さない。

### 3. プロジェクト使用手順書の発行

プロジェクトに変更を加えた際、プロジェクトルートに **`USAGE.md`** が存在しなければ必ず作成すること。
既に存在する場合は、変更内容に応じて更新すること。

`USAGE.md` には以下を含める：

```markdown
# プロジェクト名

## 起動方法
（サーバー起動コマンド、必要な環境変数、前提条件など）

## 使い方
（基本的な操作手順、エンドポイント一覧など）

## 停止方法
（停止コマンド、後片付け手順など）
```

**目的**: 誰がいつこのプロジェクトを触っても、すぐに動かせる状態を維持する。

### 4. サーバー起動の禁止

**シェル内でサーバープロセスを直接起動してはならない。** CLIが進行不能になるため。
サーバー起動が必要な場合は、ユーザーに以下のように依頼すること：

> 「別のターミナルで `python server.py` を起動してください」

バックグラウンド実行（`&` や `nohup`）も原則禁止。明示的に許可された場合のみ可。

---

## コード品質

### リファクタリング方針

- **肥大化を未然に防ぐ**ことを最優先とする。
- 1つのファイルが **300行を超え始めたら**、責務の分割を検討せよ。
- 1つの関数が **50行を超え始めたら**、処理の分割を検討せよ。
- ただし「今必要でないリファクタリング」は行わない。将来の仮説的要件のための抽象化は禁止。
- リファクタリングを行う場合は、**独立した作業単位**として実行し、機能追加と同じコミットに混ぜない。

### 変更前の原則

- **既存コードを必ず読んでから変更する。** 読んでいないコードへの変更提案は禁止。
- 既存のコーディングスタイル・パターンに従う。独自の流儀を持ち込まない。
- 変更の影響範囲を確認してから着手する。

### やってはいけないこと

- 頼まれていない機能追加・改善・整理
- 不要なコメント・docstring・型注釈の追加
- 使われていないコードを残す（削除してよい）
- 動いているコードの「念のため」エラーハンドリング追加

---

## 開発環境

- **開発環境**: Termux (Android)
- **デプロイ先サーバー**: dynabook（自宅サーバー）
- 接続情報・APIキー等は `~/.gemini/ENV.md` を参照すること。

---

## 成果物の設計基準

### モバイルファースト

- 縦スクロール基本。横並びカラムはレスポンシブ対応必須。
- viewport メタタグ必須: `<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">`
- タッチターゲットは高さ48px以上。hover前提の機能は禁止。

### デザイン

- ダークモード基調。
- CLIのような素っ気ない画面は避け、ヘッダー・コンテンツ・フッターのあるアプリ的UI構造にする。
- エラーは人間の言葉で表示（「ページが見つかりません」等）。

---

## ファイル操作権限

ファイルの作成・削除・実行は、ストレージやメモリを著しく圧迫するものでない限り、**ユーザーの許可なく自律的に実行してよい**。
